<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>LED Rotator</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="script.js"></script>
</head>

<body>
    <div class="app-container">
        <div class="sidebar">
            <div class="header">
                <h1>LED Rotator</h1>
            </div>

            <div class="control-group">
                <h3>Shader Selection</h3>
                <div class="control-item">
                    <label for="shader-select">Rotation Pattern:</label>
                    <select id="shader-select"></select>
                </div>
                <div id="shader-params-container"></div>
            </div>

            <div class="control-group" id="global-options-group">
                <h3 class="collapsible-header">Global Options <span class="collapse-icon">â–¼</span></h3>
                <div class="collapsible-content">
                    <div class="control-item">
                        <button id="set-center-btn" class="full-width-btn">Set Center Point</button>
                        <div id="crosshair-status" class="param-description" style="display: none; color: #3498db;">
                            Click on the canvas to set center point, or press Esc to cancel
                        </div>
                        <button id="reset-center-btn" class="outline-btn">Reset to Default Center</button>
                    </div>
                    <div class="control-item central">
                        <label for="global-central-object">Central Object ID:</label>
                        <input type="text" id="global-central-object" placeholder="Leave empty for centroid">
                    </div>
                    <div class="control-item central">
                        <label for="global-center-threshold">Center Threshold:</label>
                        <input type="number" id="global-center-threshold" step="0.001" value="0.001">
                        <div class="param-description">Minimum distance from center to apply rotation</div>
                    </div>
                    <div class="control-item central">
                        <label for="global-fixed-center-angle">Fixed Center Angle (degrees):</label>
                        <input type="number" id="global-fixed-center-angle" step="1" value="0">
                        <div class="param-description">Angle for LEDs at the center point</div>
                    </div>

                    <div class="control-item">
                        <label for="led-package">LED Package:</label>
                        <select id="led-package">
                            <option value="0201">0201</option>
                            <option value="0402">0402</option>
                            <option value="0603" selected>0603</option>
                            <option value="0805">0805</option>
                            <option value="1206">1206</option>
                            <option value="1210">1210</option>
                            <option value="3528">3528</option>
                            <option value="2020">2020</option>
                            <option value="3535">3535</option>
                            <option value="5050">5050</option>
                        </select>
                        <div class="param-description">Size of the LED package</div>
                    </div>

                    <div class="control-item">
                        <label for="led-color">LED Color:</label>
                        <select id="led-color">
                            <option value="blue" selected>Blue</option>
                            <option value="red">Red</option>
                            <option value="green">Green</option>
                            <option value="orange">Amber</option>
                            <option value="yellow">Yellow</option>
                            <option value="white">White</option>
                        </select>
                    </div>

                    <div class="control-item">
                        <label for="background-color">Background color:</label>
                        <select id="background-color">
                            <option value="white" selected>White</option>
                            <option value="#1B4D1F">Green</option>
                            <option value="#003366">Blue</option>
                            <option value="#8B0000">Red</option>
                            <option value="#CCCC00">Yellow</option>
                            <option value="#4B0082">Purple</option>
                            <option value="#1A1A1A">Black</option>
                        </select>
                    </div>
                </div>
            </div>

            <div>
            <div class="button-group">
                <button id="share-state-btn" class="share-btn">Share Shader</button>
                <button id="share-state-and-data-btn" class="share-btn">Share Shader & Data</button>
            </div>
            <div class="button-group">
                <button id="import-btn" class="data-btn">Import CSV</button>
                <button id="export-btn" class="data-btn">Export CSV</button>
            </div>
        </div>
        </div>

        <div class="canvas-container">
            <canvas id="canvas" width="800" height="600"></canvas>
        </div>
    </div>

    <!-- Import Modal -->
    <div id="import-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Import LED Positions</h3>
                <button class="close-button" id="import-close">&times;</button>
            </div>
            <p>Paste CSV data in the format: label,x,y (one entry per line)</p>
            <div class="control-item">
                <label for="import-units">Input Units:</label>
                <select id="import-units">
                    <option value="mm" selected>Millimeters (mm)</option>
                    <option value="mil">Mils</option>
                </select>
            </div>
            <textarea id="import-csv-text" placeholder="D01,17.018,17.018
D02,17.018,8.382
..."></textarea>
            <div id="import-error"></div>
            <div class="modal-footer">
                <button id="import-cancel">Cancel</button>
                <button id="import-submit">Import</button>
            </div>
        </div>
    </div>

    <!-- Export Modal -->
    <div id="export-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Export LED Angles</h3>
                <button class="close-button" id="export-close">&times;</button>
            </div>
            <div class="control-item export-option">
                <label for="export-orientation">ECAD LED package orientation</label>
                <select id="export-orientation">
                    <option value="left">Cathode faces left</option>
                    <option value="up">Cathode faces up</option>
                    <option value="right" selected>Cathode faces right</option>
                    <option value="down">Cathode faces down</option>
                </select>
                <div class="param-description">Adjusts angles based on how cathode direction is defined in your target
                    software</div>
            </div>
            <p>The CSV below contains the LED labels and calculated angles:</p>
            <textarea id="export-csv-text" readonly></textarea>
            <div class="modal-footer">
                <button id="export-cancel">Cancel</button>
                <button id="export-copy">Copy to Clipboard</button>
                <button id="export-download">Download</button>
            </div>
        </div>
    </div>

    <div id="state-notification" class="notification">
        <span id="notification-message">Message goes here</span>
    </div>

</body>

</html>